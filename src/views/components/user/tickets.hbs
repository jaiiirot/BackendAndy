<div class="py-2 px-4 md:px-6 2xl:px-20 2xl:container 2xl:mx-auto">
	<div class="flex justify-start item-start space-y-2 flex-col">
		<h1
			class="text-3xl lg:text-4xl font-semibold leading-7 lg:leading-9 text-gray-800"
		>Tus pedidos</h1>
	</div>
	<div
		class="mt-10 flex flex-col xl:flex-row jusitfy-center items-stretch w-full xl:space-x-8 space-y-4 md:space-y-6 xl:space-y-0"
	>
		<div
			class="flex flex-col justify-start items-start w-full space-y-4 md:space-y-6 xl:space-y-8"
		>
			<div
				class="flex flex-col justify-start items-start bg-gray-50 px-4 py-4 md:py-6 md:p-6 xl:p-8 w-full"
			>
				{{#each user.tickets}}
					<div
						class="mt-4 md:mt-6 flex flex-col md:flex-row justify-start items-start md:items-center md:space-x-6 xl:space-x-8 w-full"
					>
						<div
							class="border-b border-gray-200 flex-col flex justify-between items-start w-full pb-8 space-y-4 md:space-y-0"
						>
							<div
								class="w-full flex flex-col md:flex-row justify-between items-center"
							>
								<h3 class="text-lg font-semibold text-gray-800">Codigo:
									{{this.code}}</h3>
								<p class="text-base">{{this.purchaser}}</p>
								<p class="text-base font-semibold text-gray-800">$
									{{this.amount}}</p>
							</div>
							<div class="w-full text-center">
								<p class="text-sm text-red-800">{{this.purchase_datetime}}</p>
							</div>
						</div>
					</div>
				{{/each}}
			</div>

			<div class="flex justify-center flex-col md:flex-row flex-col items-stretch w-full space-y-4 md:space-y-0 md:space-x-6 xl:space-x-8">

				

			</div>
		</div>
		<div
			class="bg-gray-50 w-full xl:w-96 flex justify-between items-center md:items-start px-4 py-6 md:p-6 xl:p-8 flex-col"
		>
			<h3 class="text-xl font-semibold leading-5 text-gray-800">Cliente</h3>
			<div
				class="flex flex-col md:flex-row xl:flex-col justify-start items-stretch h-full w-full md:space-x-6 lg:space-x-8 xl:space-x-0"
			>
				<div class="flex flex-col justify-start items-start flex-shrink-0">
					<div
						class="flex justify-center w-full md:justify-start items-center space-x-4 py-8 border-b border-gray-200"
					>
						<img src="{{user.reqinfo.photo_user}}" alt="avatar" width="50" />
						<div class="flex justify-start items-start flex-col space-y-2">
							<p
								class="text-base font-semibold leading-4 text-left text-gray-800"
							>{{user.reqinfo.username}}</p>
							<p class="text-sm leading-5 text-gray-600">{{user.ticketsCount}}
								Pedidos Anteriores</p>
						</div>
					</div>
					<div
						class="flex justify-center text-gray-800 md:justify-start items-center space-x-4 py-4 border-b border-gray-200 w-full"
					>
						<svg
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path
								d="M19 5H5C3.89543 5 3 5.89543 3 7V17C3 18.1046 3.89543 19 5 19H19C20.1046 19 21 18.1046 21 17V7C21 5.89543 20.1046 5 19 5Z"
								stroke="currentColor"
								stroke-linecap="round"
								stroke-linejoin="round"
							/>
							<path
								d="M3 7L12 13L21 7"
								stroke="currentColor"
								stroke-linecap="round"
								stroke-linejoin="round"
							/>
						</svg>
						<p
							class="cursor-pointer text-sm leading-5"
						>{{user.reqinfo.email}}</p>
					</div>
				</div>
				<div
					class="flex justify-between xl:h-full items-stretch w-full flex-col mt-6 md:mt-0"
				>
					<div
						class="flex justify-center md:justify-start xl:flex-col flex-col md:space-x-6 lg:space-x-8 xl:space-x-0 space-y-4 xl:space-y-12 md:space-y-0 md:flex-row items-center md:items-start"
					>
						<div
							class="flex justify-center md:justify-start items-center md:items-start flex-col space-y-4 xl:mt-8"
						>
							<p
								class="text-base font-semibold leading-4 text-center md:text-left text-gray-800"
							>Dirección de Envío</p>
							<p
								class="w-48 lg:w-full xl:w-48 text-center md:text-left text-sm leading-5 text-gray-600"
							>180 North King Street, Northhampton MA 1060</p>
						</div>
						<div
							class="flex justify-center md:justify-start items-center md:items-start flex-col space-y-4"
						>
							<p
								class="text-base font-semibold leading-4 text-center md:text-left text-gray-800"
							>Dirección de Facturación</p>
							<p
								class="w-48 lg:w-full xl:w-48 text-center md:text-left text-sm leading-5 text-gray-600"
							>180 North King Street, Northhampton MA 1060</p>
						</div>
					</div>
					<div
						class="flex justify-center items-center md:justify-start items-center flex-col space-y-4 xl:mt-6"
					>
						<button
							id="submitButton"
							class="py-5 hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-800 border border-gray-800 font-medium w-96 2xl:w-full text-base font-medium leading-4 text-gray-800"
						>Enviar</button>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"></script>
<script>
  function handleFileSelect(event) {
    const file = event.target.files[0];
    if (file) {
      document.getElementById('pdfName').textContent = `Nombre del PDF: ${file.name}`;
      const reader = new FileReader();
      reader.onload = function(e) {
        const pdfData = new Uint8Array(e.target.result);
        renderPDFPreview(pdfData);
      };
      reader.readAsArrayBuffer(file);
    }
  }

  async function renderPDFPreview(pdfData) {
    try {
      const pdf = await pdfjsLib.getDocument({ data: pdfData }).promise;
      const page = await pdf.getPage(1);
      const scale = 0.5;
      const viewport = page.getViewport({ scale });
      const canvas = document.createElement('canvas');
      const context = canvas.getContext('2d');
      canvas.height = viewport.height;
      canvas.width = viewport.width;
      const renderContext = {
        canvasContext: context,
        viewport: viewport
      };
      await page.render(renderContext).promise;
      const canvasContainer = document.getElementById('pdfPreview');
      canvasContainer.innerHTML = '';
      canvasContainer.appendChild(canvas);
    } catch (error) {
      console.error('Error al renderizar vista previa del PDF:', error);
    }
  }
  async function uploadPDF() {
    const pdfFile = document.getElementById('pdfFile').files[0];
    if (!pdfFile) {
      console.error('No se ha seleccionado ningún archivo PDF.');
      return;
    }
    const uid = '666c474564d27b1bac445308'; // Aquí deberías obtener el UID correcto
    const formData = new FormData();
    formData.append('document', pdfFile);
    try {
      const response = await fetch(`/api/users/documents/${uid}`, {
        method: 'POST',
        body: formData
      });
      if (!response.ok) {
        throw new Error('Error al enviar el archivo PDF.');
      }
      alert('El archivo PDF se ha enviado correctamente.');
    } catch (error) {
      console.error('Error al enviar el archivo PDF:', error);
      alert('Hubo un error al enviar el archivo PDF. Por favor, inténtalo nuevamente.');
    }
  }
  document.getElementById('submitButton').addEventListener('click', uploadPDF);
</script>